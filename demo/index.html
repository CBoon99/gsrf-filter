<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <!-- SEO -->
  <title>GSRF Interactive Demonstration — Bounded vs Unbounded Filtering</title>
  <meta name="description" content="Interactive demonstration comparing GSRF (bounded, zero-overshoot behaviour) versus EMA on synthetic signals. Visualize gradient bounding and stability constraints.">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://zeroovershoot.com/demo/">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  
  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://zeroovershoot.com/demo/">
  <meta property="og:title" content="GSRF Interactive Demonstration">
  <meta property="og:description" content="Compare bounded (GSRF) vs unbounded (EMA) recursive filtering on synthetic signals.">
  <meta property="og:site_name" content="GSRF">
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="GSRF Interactive Demonstration">
  <meta name="twitter:description" content="Compare bounded vs unbounded recursive filtering behaviour.">
  
  <style>
    :root {
      --bg: #0b1220;
      --panel: #101a2e;
      --panel2: #0f172a;
      --text: #e7eefc;
      --muted: #9fb1d1;
      --line: #223253;
      --accent: #7dd3fc;
      --accent2: #a78bfa;
      --good: #34d399;
      --warn: #fbbf24;
      --bad: #fb7185;
      --shadow: 0 12px 40px rgba(0,0,0,.35);
      --radius: 16px;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: radial-gradient(1200px 900px at 20% 10%, #18264a 0%, transparent 55%),
                  radial-gradient(1000px 900px at 80% 20%, #2a1b4b 0%, transparent 55%),
                  var(--bg);
      color: var(--text);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }
    
    header {
      padding: 28px 18px 10px;
      max-width: 1120px;
      margin: 0 auto;
    }
    
    .title {
      display: flex;
      align-items: flex-end;
      gap: 14px;
      flex-wrap: wrap;
    }
    
    h1 {
      font-size: clamp(22px, 3vw, 34px);
      margin: 0;
      letter-spacing: .2px;
    }
    
    .badge {
      font-size: 12px;
      color: var(--muted);
      border: 1px solid rgba(125, 211, 252, .25);
      background: rgba(125, 211, 252, .08);
      padding: 6px 10px;
      border-radius: 999px;
    }
    
    .sub {
      margin: 10px 0 0;
      color: var(--muted);
      line-height: 1.5;
      max-width: 80ch;
      font-size: 14px;
    }
    
    .back-link {
      display: inline-block;
      margin-bottom: 16px;
      font-size: 13px;
      color: var(--accent);
      text-decoration: none;
    }
    
    .back-link:hover {
      text-decoration: underline;
    }
    
    main {
      max-width: 1120px;
      margin: 0 auto;
      padding: 18px;
      display: grid;
      grid-template-columns: 360px 1fr;
      gap: 16px;
    }
    
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,.06) 0%, rgba(255,255,255,.02) 100%);
      border: 1px solid rgba(255,255,255,.08);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      overflow: hidden;
    }
    
    .card .hd {
      padding: 14px 14px 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      background: rgba(16, 26, 46, .55);
    }
    
    .card .hd h2 {
      margin: 0;
      font-size: 14px;
      letter-spacing: .3px;
      color: #dbe7ff;
    }
    
    .card .bd {
      padding: 14px;
    }
    
    label {
      display: block;
      font-size: 12px;
      color: var(--muted);
      margin: 12px 0 6px;
    }
    
    select,
    input[type="range"],
    input[type="number"] {
      width: 100%;
      padding: 10px;
      border-radius: 12px;
      background: rgba(15, 23, 42, .85);
      border: 1px solid rgba(255,255,255,.10);
      color: var(--text);
      outline: none;
      font-size: 14px;
      -webkit-appearance: none;
    }
    
    input[type="range"] {
      padding: 0;
      height: 36px;
    }
    
    input[type="number"]:focus,
    select:focus {
      border-color: var(--accent);
    }
    
    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    
    .toggles {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }
    
    .chip {
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(15, 23, 42, .60);
      padding: 9px 10px;
      border-radius: 999px;
      cursor: pointer;
      user-select: none;
      font-size: 12px;
      color: #d6e3ff;
      transition: transform .05s ease, border-color .15s ease, background .15s ease;
    }
    
    .chip:hover {
      border-color: rgba(125, 211, 252, .30);
    }
    
    .chip:active {
      transform: translateY(1px);
    }
    
    .chip.active {
      border-color: rgba(125, 211, 252, .55);
      background: rgba(125, 211, 252, .10);
      box-shadow: 0 0 0 4px rgba(125, 211, 252, .06);
    }
    
    .btns {
      display: flex;
      gap: 10px;
      margin-top: 14px;
      flex-wrap: wrap;
    }
    
    button {
      border: none;
      background: linear-gradient(180deg, rgba(125, 211, 252, .24) 0%, rgba(125, 211, 252, .12) 100%);
      color: var(--text);
      border: 1px solid rgba(125, 211, 252, .30);
      padding: 10px 12px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      font-size: 13px;
      touch-action: manipulation;
    }
    
    button.secondary {
      background: rgba(15, 23, 42, .6);
      border: 1px solid rgba(255,255,255,.12);
      color: #dbe7ff;
      font-weight: 600;
    }
    
    .hint {
      margin-top: 12px;
      font-size: 12px;
      line-height: 1.5;
      color: var(--muted);
      border-top: 1px solid rgba(255,255,255,.08);
      padding-top: 12px;
    }
    
    .kpis {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 12px;
    }
    
    .kpi {
      padding: 10px;
      border-radius: 14px;
      background: rgba(15, 23, 42, .55);
      border: 1px solid rgba(255,255,255,.08);
    }
    
    .kpi .v {
      font-size: 16px;
      font-weight: 700;
    }
    
    .kpi .l {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }
    
    .chart-container {
      position: relative;
      width: 100%;
      height: 420px;
    }
    
    canvas {
      display: block;
      width: 100% !important;
      height: 100% !important;
    }
    
    .foot {
      max-width: 1120px;
      margin: 0 auto;
      padding: 0 18px 16px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.6;
    }
    
    footer {
      max-width: 1120px;
      margin: 0 auto;
      padding: 16px 18px 26px;
      border-top: 1px solid rgba(255,255,255,.08);
      text-align: center;
    }
    
    footer p {
      font-size: 12px;
      color: var(--muted);
      margin: 0;
      line-height: 1.6;
    }
    
    a {
      color: var(--accent);
    }
    
    code {
      background: rgba(255,255,255,.06);
      padding: 2px 6px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,.08);
    }
    
    /* Tablet */
    @media (max-width: 980px) {
      main {
        grid-template-columns: 1fr;
      }
      
      .chart-container {
        height: 350px;
      }
    }
    
    /* Mobile */
    @media (max-width: 600px) {
      header {
        padding: 20px 16px 10px;
      }
      
      main {
        padding: 12px;
        gap: 12px;
      }
      
      .card .bd {
        padding: 12px;
      }
      
      .row {
        grid-template-columns: 1fr;
      }
      
      .chart-container {
        height: 280px;
      }
      
      .btns {
        flex-direction: column;
      }
      
      .btns button {
        width: 100%;
      }
      
      h1 {
        font-size: 22px;
      }
      
      .foot, footer {
        padding-left: 16px;
        padding-right: 16px;
      }
    }
  </style>
</head>
<body>
  <header>
    <a href="/" class="back-link">← Back to GSRF</a>
    <div class="title">
      <h1>GSRF Interactive Demonstration</h1>
    </div>
    <p class="sub">
      Bounded versus unbounded recursive filtering under identical inputs.
      This demonstration compares GSRF (bounded, zero-overshoot behaviour) against EMA on controlled synthetic signals.
    </p>
  </header>

  <main>
    <section class="card" aria-label="Filter controls">
      <div class="hd">
        <h2>Controls</h2>
        <span class="badge" id="seedBadge">seed: 2026</span>
      </div>
      <div class="bd">
        <label for="signalType">Signal type</label>
        <select id="signalType">
          <option value="step">Step</option>
          <option value="ramp">Ramp</option>
          <option value="sine">Noisy sine</option>
        </select>

        <label id="filterLabel">Filter</label>
        <div class="toggles" id="filterToggles" role="group" aria-labelledby="filterLabel">
          <div class="chip active" data-filter="gsrf" role="button" tabindex="0" aria-pressed="true">GSRF</div>
          <div class="chip" data-filter="ema_slow" role="button" tabindex="0" aria-pressed="false">EMA (α=0.10)</div>
          <div class="chip" data-filter="ema_fast" role="button" tabindex="0" aria-pressed="false">EMA (α=0.50)</div>
          <div class="chip" data-filter="all" role="button" tabindex="0" aria-pressed="false">Show all</div>
        </div>

        <div class="row">
          <div>
            <label for="noise">Noise (σ)</label>
            <input id="noise" type="range" min="0" max="1" step="0.01" value="0.15">
          </div>
          <div>
            <label for="noiseVal">σ value</label>
            <input id="noiseVal" type="number" min="0" max="1" step="0.01" value="0.15">
          </div>
        </div>

        <div class="row">
          <div>
            <label for="band">Target band (±)</label>
            <input id="band" type="number" min="0.01" max="2" step="0.01" value="0.15">
          </div>
          <div>
            <label for="target">Target center</label>
            <input id="target" type="number" min="-5" max="5" step="0.01" value="1.00">
          </div>
        </div>

        <label>GSRF parameters</label>
        <div class="row">
          <div>
            <label for="beta">β (0–1]</label>
            <input id="beta" type="number" min="0.01" max="1" step="0.01" value="0.30">
          </div>
          <div>
            <label for="kreturn">k_return (&gt;0)</label>
            <input id="kreturn" type="number" min="0.01" max="5" step="0.01" value="1.00">
          </div>
        </div>
        <div class="row">
          <div>
            <label for="mem">mem [0–0.5]</label>
            <input id="mem" type="number" min="0" max="0.5" step="0.01" value="0.20">
          </div>
          <div>
            <label for="baseline">b (|b|&lt;2)</label>
            <input id="baseline" type="number" min="-1.99" max="1.99" step="0.01" value="0.00">
          </div>
        </div>

        <div class="btns">
          <button id="regen">Regenerate</button>
          <button class="secondary" id="stepOnce">Step once</button>
          <button class="secondary" id="run">Run 300 steps</button>
        </div>

        <div class="kpis">
          <div class="kpi">
            <div class="v" id="kpiOvershoot">—</div>
            <div class="l">Max overshoot (selected)</div>
          </div>
          <div class="kpi">
            <div class="v" id="kpiCross">—</div>
            <div class="l">Band crossings (selected)</div>
          </div>
        </div>

        <div class="hint">
          Tip: start with <code>Step</code> + <code>EMA (α=0.50)</code> to see overshoot, then switch to <code>GSRF</code>.
          "Show all" overlays all filters on the same signal.
        </div>
      </div>
    </section>

    <section class="card" aria-label="Signal visualization">
      <div class="hd">
        <h2>Signal + Filter Output</h2>
        <span class="badge" id="modeBadge">mode: gsrf</span>
      </div>
      <div class="bd">
        <div class="chart-container">
          <canvas id="chart"></canvas>
        </div>
      </div>
    </section>
  </main>

  <div class="foot">
    <p>
      Notes: Synthetic-only. This demonstration visualizes boundedness behaviour and overshoot suppression — it does not claim clinical / industrial efficacy.
      Parameter envelopes are enforced in code. <a href="/">Return to GSRF overview</a>.
    </p>
  </div>
  
  <footer>
    <p>Built by <a href="https://boonmind.io">BoonMind</a>.<br>Research, safety frameworks, and system architecture.<br>For inquiries: <a href="mailto:info@boonmind.io">info@boonmind.io</a></p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    // Utilities (seeded RNG)
    function mulberry32(seed) {
      let a = seed >>> 0;
      return function() {
        a |= 0;
        a = a + 0x6D2B79F5 | 0;
        let t = Math.imul(a ^ a >>> 15, 1 | a);
        t = t + Math.imul(t ^ t >>> 7, 61 | t) ^ t;
        return ((t ^ t >>> 14) >>> 0) / 4294967296;
      };
    }
    
    function randn(rng) {
      let u = 0, v = 0;
      while (u === 0) u = rng();
      while (v === 0) v = rng();
      return Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
    }
    
    function clamp(x, lo, hi) {
      return Math.max(lo, Math.min(hi, x));
    }

    // Signal generators
    function generateSignal({ type, n, target, noiseSigma, rng }) {
      const y = new Array(n);
      for (let i = 0; i < n; i++) {
        let base = target;
        if (type === "step") {
          base = (i < 100) ? (target - 0.8) : (target + 0.8);
        } else if (type === "ramp") {
          base = (target - 0.7) + (1.4 * i / (n - 1));
        } else if (type === "sine") {
          const w = 2 * Math.PI * (i / 60);
          base = target + 0.55 * Math.sin(w);
        }
        y[i] = base + noiseSigma * randn(rng);
      }
      return y;
    }

    // Filters
    function emaFilter(y, alpha) {
      const out = new Array(y.length);
      let s = y[0];
      out[0] = s;
      for (let i = 1; i < y.length; i++) {
        s = alpha * y[i] + (1 - alpha) * s;
        out[i] = s;
      }
      return out;
    }

    function gsrfFilter(y, params, rng) {
      const { target, beta, k_return, mem, baseline, delta } = params;
      const β = clamp(beta, 0.01, 1.0);
      const k = Math.max(0.01, k_return);
      const m = clamp(mem, 0.0, 0.5);
      const b = clamp(baseline, -1.99, 1.99);
      const δ = Math.max(0, delta);

      const minY = Math.min(...y);
      const shift = (minY <= 0) ? (1.0 - minY) : 0.0;

      const out = new Array(y.length);
      let x_star = Math.log(Math.max(target + shift, 1e-9));
      let x_prev = null;
      let x = x_star;

      for (let i = 0; i < y.length; i++) {
        const obs = Math.max(y[i] + shift, 1e-9);
        const x_obs = Math.log(obs);

        if (x_prev === null) x_prev = x_obs;

        const G = -(x - x_star);
        const R = Math.tanh(x - x_prev);
        const eta = (δ > 0) ? ((rng() * 2 - 1) * δ) : 0;

        const update = b + k * G + m * R;
        const x_new = x + β * update + eta;

        x_prev = x;
        x = x_new;
        out[i] = Math.exp(x) - shift;
      }
      return out;
    }

    // Metrics
    function calcMetrics(series, target, band) {
      let maxOvershoot = 0;
      let crossings = 0;
      let prevInside = null;
      for (let i = 0; i < series.length; i++) {
        const v = series[i];
        const overshoot = Math.max(0, Math.abs(v - target) - band);
        if (overshoot > maxOvershoot) maxOvershoot = overshoot;

        const inside = Math.abs(v - target) <= band;
        if (prevInside !== null && inside !== prevInside) crossings++;
        prevInside = inside;
      }
      return { maxOvershoot, crossings };
    }

    // UI + Chart
    const els = {
      signalType: document.getElementById("signalType"),
      noise: document.getElementById("noise"),
      noiseVal: document.getElementById("noiseVal"),
      band: document.getElementById("band"),
      target: document.getElementById("target"),
      beta: document.getElementById("beta"),
      kreturn: document.getElementById("kreturn"),
      mem: document.getElementById("mem"),
      baseline: document.getElementById("baseline"),
      regen: document.getElementById("regen"),
      stepOnce: document.getElementById("stepOnce"),
      run: document.getElementById("run"),
      kpiOvershoot: document.getElementById("kpiOvershoot"),
      kpiCross: document.getElementById("kpiCross"),
      filterToggles: document.getElementById("filterToggles"),
      modeBadge: document.getElementById("modeBadge"),
      seedBadge: document.getElementById("seedBadge"),
    };

    let seed = 2026;
    els.seedBadge.textContent = "seed: " + seed;

    // Initialize mode to match the active chip (gsrf)
    let mode = "gsrf";
    
    function setMode(newMode) {
      mode = newMode;
      [...els.filterToggles.querySelectorAll(".chip")].forEach(ch => {
        const isActive = ch.dataset.filter === newMode;
        ch.classList.toggle("active", isActive);
        ch.setAttribute("aria-pressed", isActive);
      });
      els.modeBadge.textContent = "mode: " + (mode === "all" ? "show all" : mode);
      render();
    }

    els.filterToggles.addEventListener("click", (e) => {
      const chip = e.target.closest(".chip");
      if (!chip) return;
      setMode(chip.dataset.filter);
    });
    
    // Keyboard support for chips
    els.filterToggles.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        const chip = e.target.closest(".chip");
        if (chip) {
          e.preventDefault();
          setMode(chip.dataset.filter);
        }
      }
    });

    function syncNoise(from) {
      if (from === "range") els.noiseVal.value = els.noise.value;
      if (from === "num") els.noise.value = els.noiseVal.value;
      render();
    }
    
    els.noise.addEventListener("input", () => syncNoise("range"));
    els.noiseVal.addEventListener("input", () => syncNoise("num"));

    ["signalType", "band", "target", "beta", "kreturn", "mem", "baseline"].forEach(id => {
      els[id].addEventListener("input", render);
    });

    els.regen.addEventListener("click", () => {
      seed = (seed + 1) >>> 0;
      els.seedBadge.textContent = "seed: " + seed;
      render();
    });

    const ctx = document.getElementById("chart");
    const chart = new Chart(ctx, {
      type: "line",
      data: { labels: [], datasets: [] },
      options: {
        animation: false,
        responsive: true,
        maintainAspectRatio: false,
        interaction: { mode: "index", intersect: false },
        plugins: {
          legend: { labels: { color: "#cfe0ff" } },
          tooltip: { enabled: true }
        },
        scales: {
          x: { ticks: { color: "#9fb1d1" }, grid: { color: "rgba(255,255,255,.06)" } },
          y: { ticks: { color: "#9fb1d1" }, grid: { color: "rgba(255,255,255,.06)" } }
        },
        elements: {
          point: { radius: 0 },
          line: { tension: 0.15, borderWidth: 2 }
        }
      }
    });

    let N = 300;
    
    function computeAll() {
      const rng = mulberry32(seed);
      const type = els.signalType.value;
      const target = parseFloat(els.target.value);
      const band = parseFloat(els.band.value);
      const noiseSigma = parseFloat(els.noise.value);

      const y = generateSignal({ type, n: N, target, noiseSigma, rng });
      const emaSlow = emaFilter(y, 0.10);
      const emaFast = emaFilter(y, 0.50);

      const gsrfParams = {
        target,
        beta: parseFloat(els.beta.value),
        k_return: parseFloat(els.kreturn.value),
        mem: parseFloat(els.mem.value),
        baseline: parseFloat(els.baseline.value),
        delta: 0.0
      };

      const rng2 = mulberry32(seed ^ 0xA5A5A5A5);
      const gsrf = gsrfFilter(y, gsrfParams, rng2);

      return { y, emaSlow, emaFast, gsrf, target, band };
    }

    function render() {
      const { y, emaSlow, emaFast, gsrf, target, band } = computeAll();
      const labels = Array.from({ length: y.length }, (_, i) => i);

      const bandTop = y.map(() => target + band);
      const bandBot = y.map(() => target - band);
      const targetLine = y.map(() => target);

      const datasets = [];

      datasets.push({
        label: "Raw (synthetic)",
        data: y,
        borderColor: "rgba(231,238,252,.55)",
        borderWidth: 1.5
      });

      datasets.push({
        label: "Target",
        data: targetLine,
        borderColor: "rgba(52,211,153,.55)",
        borderDash: [6, 6],
        borderWidth: 2
      });
      
      datasets.push({
        label: "Band +",
        data: bandTop,
        borderColor: "rgba(251,191,36,.35)",
        borderDash: [4, 6],
        borderWidth: 1.5
      });
      
      datasets.push({
        label: "Band -",
        data: bandBot,
        borderColor: "rgba(251,191,36,.35)",
        borderDash: [4, 6],
        borderWidth: 1.5
      });

      const show = (m) => mode === "all" || mode === m;

      if (show("gsrf")) {
        datasets.push({
          label: "GSRF",
          data: gsrf,
          borderColor: "rgba(125,211,252,.95)",
          borderWidth: 2.5
        });
      }
      
      if (show("ema_slow")) {
        datasets.push({
          label: "EMA α=0.10",
          data: emaSlow,
          borderColor: "rgba(167,139,250,.85)",
          borderWidth: 2
        });
      }
      
      if (show("ema_fast")) {
        datasets.push({
          label: "EMA α=0.50",
          data: emaFast,
          borderColor: "rgba(251,113,133,.85)",
          borderWidth: 2
        });
      }

      chart.data.labels = labels;
      chart.data.datasets = datasets;
      chart.update();

      let selectedSeries = gsrf;
      if (mode === "ema_slow") selectedSeries = emaSlow;
      if (mode === "ema_fast") selectedSeries = emaFast;
      if (mode === "all") selectedSeries = gsrf;

      const m = calcMetrics(selectedSeries, target, band);
      els.kpiOvershoot.textContent = m.maxOvershoot.toFixed(3);
      els.kpiCross.textContent = String(m.crossings);
    }

    els.stepOnce.addEventListener("click", render);
    els.run.addEventListener("click", render);

    // Initial render
    render();
  </script>
</body>
</html>
